<!DOCTYPE html>
<html lang="en">

  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="theme-color" content="#546E7A">

    

    <title>SpringMVC：框架学习</title>

    
      
    

    <link rel="canonical" href="www.diaowenjie.cn/2020/04/07/java-springMVC.html">

    
    <meta name="keywords" itemprop="keywords" content="blog,css,html,php">
    <link rel="shortcut icon" sizes="128x128" href="/avatar/favicon.png">

    <meta name="robots" content="noarchive">

   
    <style>
.site-header {
   background-color: #546E7A;
   }
.page-header {
   background: url("https://api.dujin.org/bing/1920.php") no-repeat center; -webkit-background-size: cover; -moz-background-size: cover; -o-background-size: cover; background-size:cover; max-width:100%; margin: auto;text-align: center;margin-bottom:20px;
}
</style>

    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/fade.css">
    <meta name="google-site-verification" content="tb5-LFfZ4ccQdqYC0-JKdEi3uWBF3IFo8PNsDcahigs" />
  </head>
  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    

    
      <a class="site-title" href="/">刁文杰的博客</a>
    

    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#ffffff" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#ffffff" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#ffffff" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
              
              
            
          
            
            
              
                <a class="page-link" href="/Billboard.html">Billboard</a>
              
            
          
            
            
              
                <a class="page-link" href="/about.html">About</a>
              
            
          
            
            
              
                <a class="page-link" href="/archives.html">Archives</a>
              
            
          
            
            
          
            
            
          
            
            
              
                <a class="page-link" href="/links.html">Links</a>
              
            
          
            
            
          
            
            
              
                <a class="page-link" href="/pages/tags.html">Tags</a>
              
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>


    
    
    
    
    <script>
      var OriginTitile = document.title;
      var titleTime;
      document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
          document.title = '刁文杰的博客 ' + OriginTitile;
          clearTimeout(titleTime);
        }
        else {
          document.title = '刁文杰的博客 ' + OriginTitile;
          titleTime = setTimeout(function() {
            document.title = OriginTitile;
          }, 2000);
        }});

    </script>

    <section class="page-header">
      <h1 class="project-name">SpringMVC：框架学习</h1>
      <h2 class="project-tagline"></h2>
      
        <h2 class="project-date">
        <time datetime="2020-04-07T00:00:00+08:00" itemprop="datePublished">
          
          Apr 7, 2020
        </time>
        
        
          • <span itemprop="author" itemscope itemtype=""><span itemprop="name">刁文杰的博客</span></span>
        
        </h2>
      
    </section>

    <section class="main-content fade">

      <article itemscope itemtype="">

  <header class="post-header">
      <link rel="dns-prefetch" href="//cdn.bootcss.com" />
    <h1 class="post-title" itemprop="name headline">SpringMVC：框架学习</h1>
    <p class="post-meta">
      <time datetime="2020-04-07T00:00:00+08:00" itemprop="datePublished">
        
        Apr 7, 2020
      </time>
      </p>
  </header>
<script type="text/javascript" async
src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  document.getElementsByTagName("img").className="bbb";  
  </script>
  
  <div itemprop="articleBody">
    <blockquote>
  <p>看Java SpringMVC视频学习笔记总结</p>
</blockquote>

<h2 id="目录">目录</h2>
<ul id="markdown-toc">
  <li><a href="#目录" id="markdown-toc-目录">目录</a></li>
  <li><a href="#0说明" id="markdown-toc-0说明">0.说明</a></li>
  <li><a href="#1mvc架构模式" id="markdown-toc-1mvc架构模式">1.MVC架构模式</a></li>
  <li><a href="#2springmvc概述" id="markdown-toc-2springmvc概述">2.SpringMVC概述</a>    <ul>
      <li><a href="#21-helloworld处理流程" id="markdown-toc-21-helloworld处理流程">2.1 HelloWorld处理流程。</a></li>
      <li><a href="#22-springmvc的九大组件" id="markdown-toc-22-springmvc的九大组件">2.2 springMVC的九大组件：</a></li>
    </ul>
  </li>
  <li><a href="#3springmvc配置文件" id="markdown-toc-3springmvc配置文件">3.springMVC配置文件</a></li>
  <li><a href="#4处理请求参数" id="markdown-toc-4处理请求参数">4.处理请求参数</a>    <ul>
      <li><a href="#41-url中带有参数" id="markdown-toc-41-url中带有参数">4.1 url中带有参数</a></li>
      <li><a href="#42--请求体中带有参数表单" id="markdown-toc-42--请求体中带有参数表单">4.2  请求体中带有参数，表单</a></li>
      <li><a href="#43-直接获取reques对象" id="markdown-toc-43-直接获取reques对象">4.3 直接获取reques对象</a></li>
    </ul>
  </li>
  <li><a href="#5restful风格的curd实现" id="markdown-toc-5restful风格的curd实现">5.RESTful风格的CURD实现</a></li>
  <li><a href="#5数据持久化存储保存并存储属性参数" id="markdown-toc-5数据持久化存储保存并存储属性参数">5.数据持久化存储（保存并存储属性参数）</a></li>
  <li><a href="#6处理json数据" id="markdown-toc-6处理json数据">6.处理json数据，</a>    <ul>
      <li><a href="#61-使用jquery发送ajax数据" id="markdown-toc-61-使用jquery发送ajax数据">6.1 使用jquery发送ajax数据</a></li>
      <li><a href="#62-接受和返回json数据" id="markdown-toc-62-接受和返回json数据">6.2 接受和返回json数据</a></li>
    </ul>
  </li>
  <li><a href="#8视图和视图解析器" id="markdown-toc-8视图和视图解析器">8.视图和视图解析器</a></li>
  <li><a href="#9拦截器的使用" id="markdown-toc-9拦截器的使用">9.拦截器的使用</a>    <ul>
      <li><a href="#10-其他知识" id="markdown-toc-10-其他知识">10. 其他知识</a></li>
    </ul>
  </li>
</ul>
<h2 id="0说明">0.说明</h2>

<p><a href="https://www.bilibili.com/video/BV1d4411g7tv?p=320">视频链接</a> b站的spring springMVC MyBatis视频课程，这个课程其实比较老，而且最新版的spring源码已经更改，但是其思想还是没有变的，学习基础的话还是可以看。</p>

<h2 id="1mvc架构模式">1.MVC架构模式</h2>

<p>MVC提倡，每一层都只编写自己的东西，不写任何其他的代码。主要作用就是为了分层，而分层的目的是为了解耦，解耦是为了维护的方便的分工合作。MVC架构模型如下所示：</p>

<p><a href="https://pic.tyzhang.top/image/d8Hc"><img src="https://pic.tyzhang.top/images/2020/04/07/MVC.png" alt="MVC.png" /></a></p>

<p>而在MVC中，对应的关系如下：</p>

<ul>
  <li>M: Model模型：封装和映射数据(JavaBean)</li>
  <li>V: View视图：界面的显示工作(.jsp)</li>
  <li>C: Controller控制器：控制整个网站的跳转逻辑(Servlet)，相当于路由:
    <ul>
      <li>调用业务逻辑处理</li>
      <li>跳转到某个页面</li>
    </ul>
  </li>
</ul>

<p>对应的包的分类：</p>

<ul>
  <li>com.diaowenjie.entities（实体）</li>
  <li>com.diaowenjie.dao</li>
  <li>com.diaowenjie.service</li>
  <li>com.diaowenjie.controller</li>
</ul>

<h2 id="2springmvc概述">2.SpringMVC概述</h2>

<h3 id="21-helloworld处理流程">2.1 HelloWorld处理流程。</h3>

<p>spring架构思想：</p>

<p><a href="https://pic.tyzhang.top/image/ddyA"><img src="https://pic.tyzhang.top/images/2020/04/07/springMVC.png" alt="springMVC.png" /></a></p>

<p>一个简单的helloworld数据处理流程：首先用户发送请求，前端控制器接收到请求以后，将请求分发给处理器映射器，处理器映射器根据map查找到对应的处理方法，返回给前端控制器，前端控制器将方法分配器处理器适配进行执行方法体，然后handler处理器执行方法，返回方法体参数，然后前端控制器将放回的数据分发给视图解析器，将数据解析并放回view视图，然后返回给用户进行显示。</p>

<p><a href="https://pic.tyzhang.top/image/dOsa"><img src="https://pic.tyzhang.top/images/2020/04/10/spinrmvcHelloWorld.png" alt="spinrmvcHelloWorld.png" /></a></p>

<h3 id="22-springmvc的九大组件">2.2 springMVC的九大组件：</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//处理九大组件的逻辑。  服务器启动的时候就会进行初始化。</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">initStrategies</span><span class="o">(</span><span class="nc">ApplicationContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">//初始化文件的解析</span>
    <span class="k">this</span><span class="o">.</span><span class="na">initMultipartResolver</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
    <span class="c1">//本地解析化</span>
    <span class="k">this</span><span class="o">.</span><span class="na">initLocaleResolver</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
    <span class="c1">//主题解析</span>
    <span class="k">this</span><span class="o">.</span><span class="na">initThemeResolver</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
    <span class="c1">//处理器映射</span>
    <span class="k">this</span><span class="o">.</span><span class="na">initHandlerMappings</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
    <span class="c1">//处理器适配器</span>
    <span class="k">this</span><span class="o">.</span><span class="na">initHandlerAdapters</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
    <span class="c1">//handler的异常处理器</span>
    <span class="k">this</span><span class="o">.</span><span class="na">initHandlerExceptionResolvers</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
    <span class="c1">//当处理器没有返回逻辑视图名等相关信息时，自动将请求url映射为逻辑视图名</span>
    <span class="k">this</span><span class="o">.</span><span class="na">initRequestToViewNameTranslator</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
    <span class="c1">//视图逻辑名称转换器，即允许返回逻辑视图名称，然后它会找到真实的视图</span>
    <span class="k">this</span><span class="o">.</span><span class="na">initViewResolvers</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
    <span class="c1">//这是一个关注flash开发的Map容器，不在介绍。</span>
    <span class="k">this</span><span class="o">.</span><span class="na">initFlashMapManager</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>上面所说的就是springMVC的核心组件，</p>

<ol>
  <li>MultipartResolver:文件解析器，用于支持服务器的文件上传。</li>
  <li>LocaleResolver:国际化解析器，可以提供国际化功能。</li>
  <li>ThemeResolver:主题解析器，类似于软件皮肤的转换功能。</li>
  <li>HandlerMapping:<strong>处理器映射器</strong>，SpringMVC中十分重要的内容，它会包装用户提供的一个控制器的方法和对它的一些拦截器，通过调用它便能够运行控制器。</li>
  <li>handlerAdapter<strong>:处理器适配器</strong>，因为处理器会在不同的上下文中运行，所有springMVC会先找到合适的适配器，然后运行处理器服务器方法。</li>
  <li>HandlerExceptionResolver:处理器异常解析器，处理器可能出现异常，产生异常便会用这个解析器进行处理。比如，转到指定的异常界面。</li>
  <li>RequestToViewNameTranslator:视图逻辑名转换器，有时候控制器放回一个视图的名称，通过它可以找到实际的视图，当处理器没有返回逻辑图名等相关信息是，自动将请求url映射为逻辑视图名。</li>
  <li>ViewResolver:<strong>视图解析器</strong>，当控制器返回后，通过视图解析器会把逻辑视图名称进行解析，然后定位实际视图。</li>
</ol>

<p>其中处理器映射器、处理器适配器和视图解析器为spring的三大组件。在配置文件中使用以下注解，便导入了以上三大组件。</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;mvc:annotation-driven/&gt;</span> 
</code></pre></div></div>

<h2 id="3springmvc配置文件">3.springMVC配置文件</h2>

<p>spring的入口文件，里面记录了所有需要使用对象的之前的关系。</p>

<p>resources/springmvc.xml。</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">"http://www.springframework.org/schema/beans"</span>
       <span class="na">xmlns:mvc=</span><span class="s">"http://www.springframework.org/schema/mvc"</span>
       <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="na">xmlns:context=</span><span class="s">"http://www.springframework.org/schema/context"</span>
       <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/mvc
       http://www.springframework.org/schema/mvc/spring-mvc.xsd 			
       http://www.springframework.org/schema/context  
       https://www.springframework.org/schema/context/spring-context.xsd"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!--开启注解扫描--&gt;</span>
    <span class="nt">&lt;context:component-scan</span> <span class="na">base-package=</span><span class="s">"cn.dwj"</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!--视图解析器--&gt;</span>
    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"internalResourceViewResolver"</span> <span class="na">class=</span><span class="s">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span><span class="nt">&gt;</span>
        <span class="c">&lt;!--即返回视图的前缀拼接--&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"prefix"</span> <span class="na">value=</span><span class="s">"/WEB-INF/pages/"</span><span class="nt">/&gt;</span>
        <span class="c">&lt;!--返回视图的后缀拼接--&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"suffix"</span> <span class="na">value=</span><span class="s">".jsp"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/bean&gt;</span>
    
    <span class="c">&lt;!--开启springMVC框架注解支持--&gt;</span>
    <span class="nt">&lt;mvc:annotation-driven/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</code></pre></div></div>

<h2 id="4处理请求参数">4.处理请求参数</h2>

<h3 id="41-url中带有参数">4.1 url中带有参数</h3>

<p>url:http://localhost:8080/user/student/aa</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/student/{name}"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">addStudent</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="s">"name"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">name</span><span class="o">){</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">"success"</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>便能够直接的获取到aa这个值。</p>

<h3 id="42--请求体中带有参数表单">4.2  请求体中带有参数，表单</h3>

<p>如果传递过来的的参数名与方法中的一致，可以直接的获取到。例如表单传递了三个参数data,phoneid,userName，那么就可以直接使用@Requestparam注解获取到：</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">String</span> <span class="nf">insertUserData</span><span class="o">(</span><span class="nd">@Requestparam</span><span class="o">(</span><span class="s">"data"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">data</span><span class="o">,</span><span class="nd">@Requestparam</span><span class="o">(</span><span class="s">"phoneId"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">phoneId</span><span class="o">,</span><span class="nd">@Requestparam</span><span class="o">(</span><span class="s">"userName"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">usrName</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">JSONException</span> <span class="o">{</span>
	
    <span class="c1">//转换成json数组</span>
    <span class="nc">JSONArray</span> <span class="n">jsonArray</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONArray</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">"success"</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>上面如果数据过多的话，直接写一个javabean进行传递数据。前面传递的参数与之一一对应即可。</p>

<h3 id="43-直接获取reques对象">4.3 直接获取reques对象</h3>

<p>springMVC也提供了servlet封装的request对象，这个我觉是可以进行debug的时候测试，即看前端发送了什么数据。然后进行测试，能够更好的理解。</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@ResponseBody</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/users/user_keyboard_pressure_store"</span><span class="o">,</span><span class="n">method</span> <span class="o">=</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">)</span>
<span class="c1">//通过request 这个对象可以获得用户传递过来的所有数据，然后可以进行对应的获取，其他的注解也就是简化版的此对象，不需要知道所有的数据，可以使用debug进行测试知道发来的数据类型是什么样的。</span>
<span class="c1">//以后这样的写法要少写，因为这个是servlet的写法，对于之后的不太好维护。</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">insertUserData</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">JSONException</span> <span class="o">{</span>
	
    <span class="c1">//转换成json数组</span>
    <span class="nc">String</span> <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"data"</span><span class="o">);</span>
    <span class="nc">JSONArray</span> <span class="n">jsonArray</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JSONArray</span><span class="o">(</span><span class="n">data</span><span class="o">);</span>
	<span class="c1">//获取请求体里面保存的数据。</span>
    <span class="nc">String</span> <span class="n">phoneId</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"phoneId"</span><span class="o">);</span>
    <span class="nc">String</span> <span class="n">usrName</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"userName"</span><span class="o">);</span>

    <span class="k">return</span> <span class="s">"success"</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>也相当于以上4.2的写法。</p>

<h2 id="5restful风格的curd实现">5.RESTful风格的CURD实现</h2>

<p>REST全名：Representational state Transfer，资源表现层状态转化。</p>

<ol>
  <li>资源（resources），网络实体，或者说是网络上的一个具体信息，可以是文本，图片，歌曲等等，可以使用一个url指向，类似于本地文档的路径。</li>
  <li>表现层(Respresentation) ，把资源具体呈现出来的形式。例如html、xml、json或者是二进制。</li>
  <li>状态转化(State Transfer)，即客户端对于服务器上的资源状态的更改，增删改查，对应的关键字为get查，post新建，put更新，delete删除。</li>
</ol>

<p>对比于传统的通过具体动作名称url进行指定，如下所示：</p>

<ol>
  <li>/getBook?id=1;</li>
  <li>/deleteBook?id=1;</li>
  <li>/updateBook?id=1;</li>
  <li>/addBook ；</li>
</ol>

<p>rest风格的操作更为简洁，可以将网络资源像本地资源一样进行操作，并且url的命名会更加的规范。</p>

<p><strong>eg: book/1 method = post  表示为新增id为1的book。</strong></p>

<p>实现方法：首先需要在web.xml中进行配置过滤器，因为默认的只要get和post方法，put和delete方法需要通过过滤器来进行检测到。以下为配置过滤器。</p>

<p>web.xml</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;filter&gt;</span>
    <span class="nt">&lt;filter-name&gt;</span>HiddenHttpMethodFilter<span class="nt">&lt;/filter-name&gt;</span>
    <span class="nt">&lt;filter-class&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="nt">&lt;/filter-class&gt;</span>
<span class="nt">&lt;/filter&gt;</span>

<span class="nt">&lt;filter-mapping&gt;</span>
    <span class="nt">&lt;filter-name&gt;</span>HiddenHttpMethodFilter<span class="nt">&lt;/filter-name&gt;</span>
    <span class="c">&lt;!--  注意这里  --&gt;</span>
    <span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/filter-mapping&gt;</span>
</code></pre></div></div>

<p>get、post方法为内置方法，以下 对于delete和put方法进行说明，</p>

<p>index.jsp</p>

<div class="language-jsp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;%--其中1为请求参数--%&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/user/book/1"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
    <span class="c">&lt;%--添加了一个_name 的方法--%&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">value=</span><span class="s">"delete"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"删除1号图书"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/user/book/1"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">value=</span><span class="s">"put"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"删除1号图书"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>controller.java</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//两个虽然url是相同的，但是请求方法是不一样的。</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/book/{bid}"</span><span class="o">,</span><span class="n">method</span> <span class="o">=</span> <span class="o">{</span><span class="nc">RequestMethod</span><span class="o">.</span><span class="na">PUT</span><span class="o">})</span>
<span class="nd">@ResponseBody</span> <span class="c1">//不加这个会测试不通过。</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">updateBook</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="s">"bid"</span><span class="o">)</span> <span class="nc">Integer</span> <span class="n">id</span><span class="o">){</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">"success"</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/book/{bid}"</span><span class="o">,</span><span class="n">method</span> <span class="o">=</span> <span class="o">{</span><span class="nc">RequestMethod</span><span class="o">.</span><span class="na">DELETE</span><span class="o">})</span>
<span class="nd">@ResponseBody</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">deleteBooke</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="s">"bid"</span><span class="o">)</span> <span class="nc">Integer</span> <span class="n">id</span><span class="o">){</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">"success"</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="5数据持久化存储保存并存储属性参数">5.数据持久化存储（保存并存储属性参数）</h2>

<p>有时候我们会将数据暂存在HTTP的request中去，让其可以在视图中进行展示，即在jsp中可以获取到用户传递过来的数据，那么就需要用到属性参数的保存。SpringMVC中共有三个注解可以实现：</p>

<ol>
  <li>
    <p>@RequestAttribute：获取request对象的属性值，用来传递给控制器参数</p>
  </li>
  <li>
    <p>@SessionAttribute: 在Session对象属性中，用来传递给控制器参数</p>
  </li>
  <li>
    <p>@SessionAttritubes:可以给他配置一个字符串数组，这个数组对应的是数据模型对应的键值对，也就是可以存储更多的值。</p>
  </li>
</ol>

<h2 id="6处理json数据">6.处理json数据，</h2>

<h3 id="61-使用jquery发送ajax数据">6.1 使用jquery发送ajax数据</h3>

<p>首先需要配置springMVC不要拦截静态资源，配置如下：</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--告诉前端控制器，哪些静态资源不进行拦截--&gt;</span>
<span class="c">&lt;!--以下表示/web/js 文件下的内容都不进行拦截。--&gt;</span>
<span class="nt">&lt;mvc:resources</span> <span class="na">location=</span><span class="s">"/js/"</span> <span class="na">mapping=</span><span class="s">"/js/**"</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<p>然后在index.jsp中发送ajax数据测试：</p>

<div class="language-jsp highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/jquery-3.4.1.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script&gt;</span>
        <span class="nx">$</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">(</span><span class="dl">"</span><span class="s2">#btn</span><span class="dl">"</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

                <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
                   <span class="na">url</span><span class="p">:</span><span class="dl">"</span><span class="s2">user/testAjax</span><span class="dl">"</span><span class="p">,</span>
                    <span class="na">contentType</span><span class="p">:</span><span class="dl">"</span><span class="s2">application/json;charaset=UTF-8</span><span class="dl">"</span><span class="p">,</span>
                    <span class="na">data</span><span class="p">:</span><span class="dl">'</span><span class="s1">{"username":"hehe","age":30}</span><span class="dl">'</span><span class="p">,</span>
                    <span class="na">dataType</span><span class="p">:</span><span class="dl">"</span><span class="s2">json</span><span class="dl">"</span><span class="p">,</span>
                    <span class="na">type</span><span class="p">:</span><span class="dl">"</span><span class="s2">post</span><span class="dl">"</span><span class="p">,</span>
                    <span class="na">success</span><span class="p">:</span><span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">alert</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">});</span>
                <span class="c1">// alert("hello");</span>
            <span class="p">});</span>
        <span class="p">});</span>
    <span class="nt">&lt;/script&gt;</span>

<span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"btn"</span><span class="nt">&gt;</span>发送ajax请求<span class="nt">&lt;/button&gt;</span>
</code></pre></div></div>

<h3 id="62-接受和返回json数据">6.2 接受和返回json数据</h3>

<p>使用@RequestBody注解以string对象的方法获取json数据：</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//模拟异步的ajax模拟</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/testAjax"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testAjax</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">String</span> <span class="n">user</span><span class="o">){</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"收到了ajax数据"</span><span class="o">);</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
<span class="o">}</span>

<span class="c1">//附user bean</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">age</span><span class="o">;</span>
    <span class="c1">//get and set</span>
<span class="o">}</span>
</code></pre></div></div>

<p>使用jackson将json转成对象。</p>

<p>1.首先在pom文件中导入需要的jar包依赖。</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--Jackson required包--&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.core<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>jackson-core<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>2.9.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.core<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>jackson-databind<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>2.9.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.fasterxml.jackson.core<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>jackson-annotations<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>2.9.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<p>2.系统便会自动的将json数据转成user对象。加上ResponseBody注解，系统会将user对象转成json返回。</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//模拟异步的ajax模拟</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/testAjax"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@ResponseBody</span> <span class="nc">User</span> <span class="nf">testAjax</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">User</span> <span class="n">user</span><span class="o">){</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"收到了ajax数据"</span><span class="o">);</span>
    <span class="c1">//此时的数据已经将其转换成了对象。</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
    <span class="n">user</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="s">"11"</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">user</span><span class="o">;</span>
<span class="o">}</span>

<span class="c1">//附user bean</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">age</span><span class="o">;</span>
    <span class="c1">//get and set</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="8视图和视图解析器">8.视图和视图解析器</h2>

<p>请求处理方法执行完成后，最终返回一个ModelAndView对象，对于那些返回String，view或ModeMap等类型的处理方法，SpringMVC也会在内部将它们转配成一个ModeAndView对象，它包含逻辑名和模型对象的实体。SpringMVC借助视图解析器得到最终的视图对象，最终的视图可以是JSP，也可以是Excel、JFreeChart等各种表现形式的视图。</p>

<p><strong>什么叫做视图？</strong></p>

<p>视图的作用就是渲染模型数据，将模型中的数据以某种形式展示给用户。SpringMVC中定义了一个抽象接口View，具体的实现由视图解析器将视图对象进行实例化。另外，由于视图是无状态的，所有他们不会有线程安全问题。</p>

<h2 id="9拦截器的使用">9.拦截器的使用</h2>

<p>SpringMVC提供了拦截器机制，即允许在运行controller 方法<strong>之前或之后</strong>运行一些方法，作为数据的筛选或者拦截工作。其实也就是相当于安卓中的声明周期。</p>

<p>filter：javaWEB实现。</p>

<p>HandelerInterceptor拦截器：SpringMVC实现。</p>

<ol>
  <li>preHandle：在目标方法之前进行调用，return true 放行，false 不放行。</li>
  <li>postHandle： 在目标方法运行之后运行。</li>
  <li>afterCompletion： 在整个请求完成以后执行。</li>
</ol>

<p><a href="https://pic.tyzhang.top/image/dVG0"><img src="https://pic.tyzhang.top/images/2020/04/13/interceptor.png" alt="interceptor.png" /></a></p>

<p>实现方法：</p>

<p>首先新建一个自定义拦截器。</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//每个方法都会传进来resquest和response对象，这样便能够对其进行操作。</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyFirstInterceptor</span> <span class="kd">implements</span> <span class="nc">HandlerInterceptor</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">preHandle</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">handler</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postHandle</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">handler</span><span class="o">,</span> <span class="nc">ModelAndView</span> <span class="n">modelAndView</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>

    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterCompletion</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">handler</span><span class="o">,</span> <span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>

    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>进行springMVC的配置，即让容器加载这个自定义的容器。以下为配置多个拦截器的方法。其中将bean标签更改自己的class即可。</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- 配置拦截器 --&gt;</span>
<span class="nt">&lt;mvc:interceptors&gt;</span>
    <span class="c">&lt;!-- 多个拦截器，按顺序执行 --&gt;</span>        
    <span class="nt">&lt;mvc:interceptor&gt;</span>
        <span class="nt">&lt;mvc:mapping</span> <span class="na">path=</span><span class="s">"/**"</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- 表示拦截所有的url包括子url路径 --&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"ssm.interceptor.HandlerInterceptor1"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/mvc:interceptor&gt;</span>
    
    <span class="nt">&lt;mvc:interceptor&gt;</span>
        <span class="nt">&lt;mvc:mapping</span> <span class="na">path=</span><span class="s">"/**"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"ssm.interceptor.HandlerInterceptor2"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/mvc:interceptor&gt;</span>
    
    <span class="nt">&lt;mvc:interceptor&gt;</span>
        <span class="nt">&lt;mvc:mapping</span> <span class="na">path=</span><span class="s">"/**"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"ssm.interceptor.HandlerInterceptor3"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/mvc:interceptor&gt;</span>
<span class="nt">&lt;/mvc:interceptors&gt;</span>
</code></pre></div></div>

<p>对于多个拦截器来说，其运行是属于栈的运行近结构，如下,三个拦截器都放行。</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HandlerInterceptor1….preHandle
HandlerInterceptor2….preHandle
HandlerInterceptor3….preHandle

HandlerInterceptor3….postHandle
HandlerInterceptor2….postHandle
HandlerInterceptor1….postHandle

HandlerInterceptor3….afterCompletion
HandlerInterceptor2….afterCompletion
HandlerInterceptor1….afterCompletion
</code></pre></div></div>

<p><a href="https://blog.csdn.net/eson_15/article/details/51749880">参考链接</a></p>

<h3 id="10-其他知识">10. 其他知识</h3>

<p>对于springMVC还有其他的东西，比如说文件的上传和jsr验证，即数据的格式验证，比如说邮箱格式，密码长度等等。国际化等操作，国际化即为在更改浏览器语言的时候，所有的文字会变成英文，这些都不在赘述。还有就是网络请求的请求头session 和cookie的设置，有机会在进行更新。</p>

<p>另外，就是重定向，使用关键字forward和redirect关键字。</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/handler"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">handler</span><span class="o">(){</span>
  
    <span class="k">return</span> <span class="s">"redirct:/hello.jsp"</span><span class="o">;</span>
    <span class="c1">//return "forward:/hello.jsp";</span>
<span class="o">}</span>
</code></pre></div></div>

  </div>

    
<footer>
    <div style="color: #B0BEC5">标签：
    
    <a class="tag" style="color: #E91E63;font-weight:bold" href="/pages/tags#SSM">#SSM</a>
    
  </div>
</footer>






  
  
  

  
  
</article>


      <footer class="site-footer">
        <!-- <span class="site-footer-owner"> 刁文杰的博客©2018-2019.</span> -->
        
      <center>
          <span class="site-footer-credits">刁文杰的博客©2018-2020.</span><br>
          <!-- <span class="site-footer-credits" style="font-size:12px">Already <span id="sitetime"></span> days.</span><br> -->
          <!-- <span class="site-footer-credits" href>浙ICP备2020039014号</span><br> -->
          <a href="http://beian.miit.gov.cn/" class="site-footer-credits"> 浙ICP备2020039014号</a> <br>
      </center>

     
        

      </footer>
    </section>

    

    
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      inlineMath: [['$','$']]
    }
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>


      <script>
          ajax()
  function ajax(option){
    var xhr = null;
    if(window.XMLHttpRequest){
      xhr = new window.XMLHttpRequest();
    }else{ // ie
      xhr = new ActiveObject("Microsoft")
    }
    xhr.open("get","");
    xhr.send(null);
    xhr.onreadystatechange = function(){
      var time = null,
          curDate = null;
      if(xhr.readyState===2){
        // Get time
        time = xhr.getResponseHeader("Date");
        console.log(xhr.getAllResponseHeaders())
        curDate = new Date(time);
        document.getElementById("sitetime").innerHTML = (parseInt((((curDate.getTime() / 1000) - 1571133419 ) / 86400 )));
        
      }
    }
  }
      </script>
      
      <script src = '/assets/js/instantclick.min.js' data-no-instant></script>
      <script data-no-instant>InstantClick.init();</script>
      
  </body>
</html>
